<!DOCTYPE html>
<html 	xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorator="layout/default">

	<head>
	    <title>자산정보수정</title>
	</head>
        
	<!-- css -->
	<th:block layout:fragment="css">
	    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,600,400' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="/css/jsgrid.css" />
		<link rel="stylesheet" href="/css/theme.css" />
	</th:block>
	
	<th:block layout:fragment="script">
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>
		<script src="/js/jsgrid/db.js"></script>
	    <script src="/js/jsgrid/jsgrid.core.js"></script>
	    <script src="/js/jsgrid/jsgrid.load-indicator.js"></script>
	    <script src="/js/jsgrid/jsgrid.load-strategies.js"></script>
	    <script src="/js/jsgrid/jsgrid.sort-strategies.js"></script>
	    <script src="/js/jsgrid/jsgrid.field.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.text.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.number.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.select.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.checkbox.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.control.js"></script>	
		
	    <script>
	    
	    let numOfRows = 30;
	    var status = true;
        var selectedItems = [];
	 	var insertedItems = [];
	 	var updatedItems = [];
	 	var codeGrpMngList = [];
	 	
		var asetType = [];
	 	var asetArr1 = [];
	 	var asetArr2 = [];
	 	var asetArr3 = [];
	 	
	    $(function(){
	    	
	        var selectItem = function(item) {
		    	if(!selectedItems.includes(item))
			    selectedItems.push(item);
			    if($(".singleCheckbox").length == $(".singleCheckbox:checked").length) {
	             $("#selectAllCheckbox").prop("checked", true);
	         } else {
	             $("#selectAllCheckbox").prop("checked", false);
	         }
			};
		     
		    var unselectItem = function(item) {
			    selectedItems = $.grep(selectedItems, function(i) {
			    return i !== item;
			    });
			    if(selectedItems.length == 0) {
			    	$('#selectAllCheckbox').attr('checked', false);
			    }
			    if($(".singleCheckbox").length == $(".singleCheckbox:checked").length) {
	             $("#selectAllCheckbox").prop("checked", true);
	         } else {
	             $("#selectAllCheckbox").prop("checked", false);
	         }
		    };
	        
	        $("#pager").on("change", function() {
	            var page = parseInt($(this).val(), 10);
	            $("#jsGrid").find(".jsgrid-table").append("<tr class='jsgrid-row'></tr>");
	        });

	        ////////////////////////////////////////////////////////////////////
    	    $(".btn_add").click(function() {
    	    	//$("#jsGrid").jsGrid("option", "inserting", "true");
    	    	showDetailForm();
    	    });
    	    
			$(".btn_del").click(function() {
   	    		
	  	    	var arr_item =  [];
	  	    	var items = [];
	  	    	
	  	    	// $("#jsGrid").jsGrid("deleteItem",delete_item);
	  	    	$.each(selectedItems, function(index,item){
	  	    		items.push(item);
	  	    	});
	  	    	
	  	    	//별도 호출
	  	    	let url = "/aset/update/reqmas/reqmasDelete";
	  			let reqType = 'GET';
	  			dataType: 'json';
	  			let data={
	  				"items": items.join(",")
	  			}
	  			
	  			$.commRequest(url, reqType, data)
	  				.then((res) => {
	  					console.log(res);
	  					alert("삭제 되었습니다!");
	  					selectedItems = [];
	  					$('.btn_srch').click();
	  				})
	  				.catch((error) => {
	  					alert("오류가 발생했습니다");
	  					console.log(error);
	  				})
    	    });
    	    
    	    $(".btn_download").click(function() {
    	    	//$("#jsGrid").jsGrid().trigger("");
    	    });
    	    
    	    $(".btn_srch").on("click",function (){
	    	   $("#jsGrid").jsGrid().trigger("loadData");
	        });
	        
	     	// 팝업창 저장 버튼 처리
            $('.save_btn').on('click', function (e) {
                
            	if (validationCheck() == '202') {
	            	e.preventDefault();
	                
	                var insert_item = {};
	                	insert_item.reqNo       = $(".detail_table").find("#reqNo").val();
		                insert_item.reqType 	= $(".detail_table").find("#reqType").val();
		                insert_item.reqNm 	    = $(".detail_table").find("#reqNm").val();
		                insert_item.reqtr 	    = $(".detail_table").find("#reqtr").val();
		                insert_item.appvDocId 	= $(".detail_table").find("#appvDocId").val();
		                insert_item.reqRsn 	    = $(".detail_table").find("#reqRsn").val();
		                insert_item.reqStus 	= $(".detail_table").find("#reqStus").val();
		                insert_item.movePupos 	= $(".detail_table").find("#movePupos").val();
		                insert_item.moveDt 	    = $(".detail_table").find("#moveDt").val();
		                insert_item.tkoutScheYn = $(".detail_table").find("#tkoutScheYn").val();
		                insert_item.tkoutScheDt = $(".detail_table").find("#tkoutScheDt").val();
		                insert_item.tkoutYn 	= $(".detail_table").find("#tkoutYn").val();
		                insert_item.tkoutDt 	= $(".detail_table").find("#tkoutDt").val();
		                insert_item.rtkinYn 	= $(".detail_table").find("#rtkinYn").val();
		                insert_item.rtKinDt 	= $(".detail_table").find("#rtKinDt").val();
		                insert_item.prgsDcontYn = $(".detail_table").find("#prgsDcontYn").val();
		                
			        var action = "";
			        
			        
			        
			    	if(save_mode == "insert") {
			    		action = "insertItem";
			    		//insertedItems.push(insert_item); --일괄
			    	}else if(save_mode == "update") {
			    		action = "updateItem";
			    		//updatedItems.push(insert_item); --일괄
			    	}
	    			
	    			$("#jsGrid").jsGrid(action, insert_item);
	                
		    		clearDetailForm();
	                $(this).parents("#detailForm").hide();
	                save_mode = "";
	          	}
            });
	     	
    	  	//수정 버튼
    	    $(".btn_update").click(function() {
    	    	var items = $("#jsGrid").jsGrid("option", "data");
    	    	var item = items.filter(arr => arr.codeId == selectedItems[0].codeId);
    	    	showDetailForm(item[0]);
    	    });
          	
          	//리셋 버튼
    	    $(".btn_reset").click(function() {
    	    	$("#req_no").val("");
    	    	$("#fromDate").val("");
    	    	$("#toDate").val("");
    	    	$("#req_nm").val("");
    	    	$("#dept_cd1").val("");
    	    	$("#dept_nm1").val("");
    	    	$("#dept_cd2").val("");
    	    	$("#dept_nm2").val("");
    	    	$("#Reqtr").val("");
    	    	$("#aset_no").val("");
    	    	$("#req_stus option:eq(0)").prop("selected",true);
    	    });
	     	
          	// #codeGrpId option:eq("+ find_idx +")").prop("selected",true);
          	
	     	// 팝업창 닫기 버튼 처리
            $('.close_btn').on('click', function (e) {
                e.preventDefault();
                clearDetailForm();
                $(this).parents("#detailForm").hide();
                selectedItems = [];
            });
	     	
            //drag 활성화
	     	$("#detailForm").draggable();
            
            //팝업 가운데로 띄우기
            jQuery.fn.center = function () {
                this.css("position","absolute");
                this.css("top", Math.max(0, (($(window).height() - $(this).outerHeight()) / 2) + $(window).scrollTop()) + "px");
                this.css("left", Math.max(0, (($(window).width() - $(this).outerWidth()) / 2) + $(window).scrollLeft()) + "px");
                return this;
            }
            
            //공통코드팝업(트리) 호출 
     	    $("#openDeptPopup1").on("click", function() { 
     	       // 팝업 호출 url
    	        var url = "/common/popup/deptTreePopup";
    	        var popId = "DeptPopup";
    	        var args = {
    	        };
    	        args.width = 500;
    	        args.height = 450;
    	        args.fullscreen = "no";
    	        args.resizable = "no";
    	        
    	        var param = {};
    	        param.id    = "bizDept";
    	        param.value = "BIZ_DEPT";
    	        
    	        openPopup(popId, url, args, param);
     	    });
    	  	
     	    $("#openDeptPopup2").on("click", function() { 
        	    // 팝업 호출 url
       	        var url = "/common/popup/deptTreePopup";
       	        var popId = "DeptPopup";
       	        var args = {
       	        };
       	        args.width = 500;
       	        args.height = 450;
       	        args.fullscreen = "no";
       	        args.resizable = "no";
       	        
       	     	var param = {};
 	        	param.id    = "dept";
 	        	param.value = "DEPT";
       	        
       	        openPopup(popId, url, args, param);
        	});
     	    
    	 	// 엑셀 다운로드
			$(".btn_excelDown").on("click", function(){
				
		       	event.preventDefault();
                let url = "/aset/update/reqmas/reqInqrExcel";
				
				var $form = $('<form id="downForm"></form>'); 
					$form.attr('action', url); 
					$form.attr('method', 'post'); 
					$form.attr('target', '_self');
					
				var idArr = ['req_no', 'fromDate', 'toDate', 'req_nm', 'dept_cd1', 'dept_cd2', 'Reqtr', 'aset_no', 'req_stus'];
				var inputStr = '';
				
				$.each(idArr,function(i){
					inputStr = $('<input type="hidden" value="'+ $("#" + idArr[i]).val() + '" name="' + idArr[i] +'">');
					$form.append(inputStr);
				});
					$form.appendTo('body'); 
					$form.submit();
			});
    	 	
			// 사용자 팝업 호출
	        $("#openUserPopup").on("click", function() { 
		        // 팝업 호출 url
		        var url = "/common/popup/userPopup";
		        var popId = "userPopup";
		        var args = {};
		        args.width = 650;
		        args.height = 416;
		        args.fullscreen = "no";
		        args.resizable = "no";
		        
		        openPopup(popId, url, args);
		    });
	        			
			/*-------------------------------------------------------------------------*/			
	        (async () => {	        	
  				console.log(">>>>>> step 1 asetArr1 " + asetArr1.length);  				
  				await asetTypeList();
  				await jsGridLoad();
  				//await asetTypeSel();
  				})();			
	        /*-------------------------------------------------------------------------*/
	        
    	});
	    
	 	// 사용자 선택 팝업에서 받은 결과 처리
	    function setResult(obj) {
			$("#reqtr").val(obj.userId);
		}
	    
	    function setResult3(obj) {
			if(obj.deptCd.length <= 6) {
				$("#dept_cd1").val(obj.deptCd);
				$("#dept_nm1").val(obj.deptNm);
			}
			else{
				$("#dept_cd2").val(obj.deptCd);
				$("#dept_nm2").val(obj.deptNm);
			}
		}

		// asetType 리스트 출력
	    async function asetTypeList() {
			
	    	console.log('--------------- asetTypeList ------------------');
			
		 	let url = '/common/popup/asetType';                                                      
		 	let reqType = 'POST';                                                                        
		 	let data = {                                                                                 
		 		"email" : ""                                                                             
		 	};                                                                                           
		 	await $.commRequest(url, reqType, JSON.stringify(data))                                            
		 		.then((res) => {
		 			
		 			$.each(res.data, function(index, el){                                                        
		 				asetType.push(el);
		 				
		 				if(el.codeLvl == '1') {
			 				asetArr1.push({Id : el.codeId, Nm:el.codeNm});
		 				}
		 			})
		 			
		 			console.log(">>>>>> step 2 asetArr1 " + asetArr1.length);
		 			//jsGridLoad();
		 		})
		 		
		 		.catch((error) => {                                                                      
		 			alert('조회 실패!!');                                                                  
		 		});
		};
		
		function jsGridLoad() {
			console.log('--------------- jsGridLoad ------------------');
	 		
	 		 $("#jsGrid").jsGrid({
		        	height: "600",
	                width: "100%",
	                filtering: false,
	                editing: true,
	                inserting: true,
	                sorting: true,
	                paging: true,
	                sorter: "number",
	                pageIndex:1,
	                pageFirstText:'<a class="first"><img src="/images/common/btn_pn_first.gif"></img></a>',
	                pagePrevText: '<a class="pre"><img src="/images/common/btn_pn_pre.gif"></img></a>',
	                pageNextText: '<a class="next"><img src="/images/common/btn_pn_next.gif"></img></a>',
	                pageLastText: '<a class="last"><img src="/images/common/btn_pn_last.gif"></img></a>',
	                pagerFormat: "{first} {prev} {pages} {next} {last}",
	                pagerContainer:null,
	                pageLoading: true,
	                pager: "#pager",
	                autoload: status,
	                pageSize: numOfRows,
	                pageButtonCount: 5,
	                loadonce: true,
	                updateOnResize: true,
		            rowClick: function(args) {
		            	var target = args.event.target;
		            	
						if(target instanceof HTMLTableCellElement) {
							
						} else {
						   	$("<input>").attr("type", "checkbox").attr("class","singleCheckbox")
						                .prop("checked", $.inArray(args.item.firstName, selectedItems) > -1)
						                .on("change", function () {
							  	 $(this).is(":checked") ? selectItem(item) : unselectItem(item);
							});
						}
		            },
		            pagerContainerClass: "paginate",
		            deleteConfirm: function(item) {
		                return "\""+item.menuNm+"("+menuId+")"+"\""+ "을 삭제 하시겠습니까?";
		            },
		            controller:  {
		                loadData: function(filter) {
		                    var d = $.Deferred();
		                    
		                    currentPage = filter.pageIndex;
		                    let url = "/asset/update/reqmas/reqInqrPopup";
							let reqType = 'GET';	
							let data = {
	            				"currentPage"  : filter.pageIndex,
	            				"numOfRows"    : numOfRows,
	            				"reqNo"		   : $("#req_no").val(),
	            				"sortField"    : filter.sortField,
	            				"sortOrder"    : filter.sortOrder
	            			}
							
							$.commRequest(url, reqType, data)
								.then((res) => {
									
									$("#reqType").val((res.data)[0].reqTypeNm);
									$("#reqNo").val((res.data)[0].reqNo);
									$("#reqDt").val((res.data)[0].reqDt);
									$("#deptNm").val((res.data)[0].deptNm);
									$("#deptCd").val((res.data)[0].deptCd);
									$("#reqtr").val((res.data)[0].reqtr);
									$("#reqNm").val((res.data)[0].reqNm);
									$("#reqRsn").val((res.data)[0].reqRsn);
									
									$(".result").text("Results : " + res.condition.totalCount);
									d.resolve({data : res.data2, itemsCount: res.condition.totalCount});
								})
								.catch((error) => {
									console.log('메뉴조회 실패!!');
								});						
		                    
		                    return d.promise();
		                },
		                
			            updateItem: function(item) { 
		                	let url = "/asset/update/reqmas/reqmasUpdate";
		                	let reqType = 'GET';
		                	$.commRequest(url, reqType, item)
		                		.then((res) => {
		                			console.log(res);
		                			unselectItem(item);
		                			
		                			alert("수정이 완료되었습니다.");
		                			selectedItems = [];
		                			$("#jsGrid").jsGrid("loadData");
		                		})
		                		.catch((error) => {
		                			console.log(error);
		                		})
		                },
		                
		                deleteItem: function(item) { 
		        			let url = "/asset/update/reqmas/reqmasDelete";
		        			let reqType = 'GET';
		        			$.commRequest(url, reqType, item)
		        				.then((res) => {
		        					console.log(res);
		        					
		        					$("#jsGrid").jsGrid("loadData");
		        				})
		        				.catch((error) => {
		        					console.log(error);
		        				})
		            	},
		                
		             	insertItem: function(item) { 
		             		//insertedItems.push(item);
		        			let url = "/asset/update/reqmas/reqmasInsert";
		        			let reqType = 'GET';
		        			
		        			$.commRequest(url, reqType, item)
		        				.then((res) => {
		        					console.log(res);
		        					
		        					$("#jsGrid").jsGrid("loadData");
		        				})
		        				.catch((error) => {
		        					console.log(error);
		        				})
		            	},
	           		},
		            fields: [
		            	{  	   name : "chk"
		                	 , align: "center"
		                	 , width: 10
		                	 , title: ""
		                	 , editing: false
		                	 , sorting: false
		                	 , filtering: false
		                	 , itemTemplate: function(value, item) {
		                       return $("<input>").attr("type", "checkbox").attr("class","singleCheckbox")
		                       .prop("checked", $.inArray(item.firstName, selectedItems) > -1)
		                       .on("change", function () {
		  					  	 $(this).is(":checked") ? selectItem($(this).parent().next().text()) : unselectItem($(this).parent().next().text());
		  					  	 });
		            		   }
		                	 , headerTemplate : function ()  { 
							  	 return  $("<input>").attr("type", "checkbox").attr("id","selectAllCheckbox")
			                     .on("change", function (item) {
			             	    	selectedItems = [];
			            	    	if(this.checked) { // check select status
			            	            $('.singleCheckbox').each(function() { 
			            	                this.checked = true;   
			            	                selectItem($(this).parent().next().text());           
			            	            });			         
			            	        }else {
			            	        	
			            	            $('.singleCheckbox').each(function() { 
			            	                this.checked = false;      
			            	                unselectItem(item);
			            	            });  
			            	            selectedItems = [];
			            	        }
			    				   });
						 	 } ,
		                },
		                { name: "asetNo", type: "text", width: 35 ,align: "left", title: "자산번호", editing: false},
		                { name: "asetType1", type:"select", width: 35, align:"left", title:"자산유형1", editing: false,
		                	itemTemplate : function(value, item){
		                		var str = "";
		                		
		                		let idx = $("#jsGrid").jsGrid("option", "data").findIndex(arr => arr.asetNo == item.asetNo) + 1;
		                		var str = '<select id="asetType1'+idx+'" style="width:100%;" onChange="getAsetTypeId1(this.id, this.value)"><option value="none">선택</option>'
		                		
			                	$.each(asetArr1, function(i){
			                		str += '<option value=' + asetArr1[i].Id + '>' + asetArr1[i].Nm + '</option>';
			                	});
		                		
			                	str += '</select>';
			                	
			                	$('#asetType1'+idx+" "+'option[value='+value+']').attr('selected', true);
			                	
			                	return str;
			                  }
		                },
		                { name: "asetType2", type:"select", width: 35, align:"left", title:"자산유형2", editing: false,
		                	itemTemplate : function(value, item){
		                		var str = "";
		                		
		                		let idx = $("#jsGrid").jsGrid("option", "data").findIndex(arr => arr.asetNo == item.asetNo) + 1;
		                		var str = '<select id="asetType2'+idx+'" style="width:100%;" onChange="getAsetTypeId2(this.id, this.value)"><option value="none">선택</option>'
		                		
		                		asetArr2 = getAsetType(item.asetType1);
		                		
			                	$.each(asetArr2, function(i){
			                		str += '<option value=' + asetArr2[i].codeId + '>' + asetArr2[i].codeNm + '</option>';
			                	});
			                	
			                	str += '</select>';
			                	
			                	return str;
			            	}
		                },
						{ name: "asetType3", type:"select", width: 35, align:"left", title:"자산유형3", editing: false,
		                	itemTemplate : function(value, item){
		                		// var asetVal3 = "";
		                		var str = "";
		                		
		                		let idx = $("#jsGrid").jsGrid("option", "data").findIndex(arr => arr.asetNo == item.asetNo) + 1;
		                		var str = '<select id="asetType3'+idx+'" style="width:100%;"><option value="none">선택</option>'
		                		
		                		asetArr3 = getAsetType(item.asetType2);
		                		
			                	$.each(asetArr3, function(i){
			                		str += '<option value=' + asetArr3[i].codeId + '>' + asetArr3[i].codeNm + '</option>';
			                	});
		                		
			                	str += '</select>';
			                	
			                	return str;
			                  }
		                },
						{ name: "mftco"	    , type: "text", width: 30 ,align: "left", title: "메이커",
		                	itemTemplate : function(value, item){
			                	
		                		let idx = $("#jsGrid").jsGrid("option", "data").findIndex(arr => arr.asetNo == item.asetNo) + 1;
		                		
			                	var str = '<input type="text" style="width:100%;" value='+item.mftco+'>'
			                	  
			                	return str;
			            	}, editing: false	
						},
						{ name: "model"	    , type: "text", width: 40 ,align: "left", title: "모델",
							itemTemplate : function(value, item){
			                	  
								var str = '<input type="text" style="width:100%;" value='+item.model+'>'
			                	  
			                	return str;
			                }, editing: false	
						},
						{ name: "sn"     	, type: "text", width: 30 ,align: "left", title: "S/N",
							itemTemplate : function(value, item){
			                	
								let idx = $("#jsGrid").jsGrid("option", "data").findIndex(arr => arr.asetNo == item.asetNo) + 1;
								
								var str = '<input type="text" style="width:100%;" value='+item.sn+'>'
			                	  
			                	return str;
			                  }, editing: false	
						},
						{ name: "bizDeptNm"	, type: "text", width: 40 ,align: "left", title: "사업부",editing: false},
						{ name: "deptNm"    , type: "text", width: 40 ,align: "left", title: "부서", editing: false},
						{ name: "chrgr"	    , type: "text", width: 30 ,align: "left", title: "담당자", editing: false,
							itemTemplate : function(value, item) {
							// var str = '<a href="#" id="openUserPopup"><img title="의뢰자 검색" class="ico_search" alt="Search" src="/images/common/ico_search.png"></a>';

							let idx = $("#jsGrid").jsGrid("option", "data").findIndex(arr => arr.asetNo == item.asetNo) + 1;
							
							var chrgrStr = '<input type="text" style="width:100%" readonly value='+item.chrgr+'>'
							
		                    var str = $("<a href='#' id='openUserPopup'><img title='의뢰자 검색' class='ico_search' alt='Search' src='/images/common/ico_search.png'></a></div>")
		                    .click(function(e) {
		                    	var url = "/common/popup/userPopup";
		            	        var popId = "userPopup";
		            	        var args = {};
		            	        args.width = 650;
		            	        args.height = 400;
		            	        args.fullscreen = "no";
		            	        args.resizable = "no";
		            	        
		            	        openPopup(popId, url, args);
		                    });
							
		                    return $("<div style='display:flex'>").append(chrgrStr).append(str);
							}
						},
		            ]
		        });
	 	}
	 	
	 	/* // 자산유형 option 선택
	    function asetTypeSel(idx, val) {
	    	console.log(idx);
	    	console.log(val);
	    	
	    	$('#asetType11 option[value='+val+']').attr('selected', true);
	    	$('#asetType12 option[value='+val+']').attr('selected', true);
	    	$('#asetType13 option[value='+val+']').attr('selected', true);
	    	// $('#asetType1'+(idx)+" "+'option:contains('+ val +')').prop('selected', true);
	    	
	    	console.log('#asetType1'+idx+' option[value='+val+']');
	    } */
	    
	 	// 자산유형 option 선택
	    function asetTypeSel() {
	    	
	    	console.log('--------------- asetTypeSel ------------------');
	    	
	    	console.log("---- asetArr1------ " + asetArr1.length)
	    	
	    	$.each(asetArr1, function(idx, el) {
		    	$('#asetType1'+(idx+1)+" "+'option:contains('+ el.Nm +')').prop('selected', true);
	    	})
	    	
	    	/* $.each(asetArr2, function(idx, el) {
		    	$('#asetType2'+(idx+1)+" "+'option:contains('+ el.codeNm +')').prop('selected', true);
	    	})
	    	
	    	$.each(asetArr3, function(idx, el) {
		    	$('#asetType3'+(idx+1)+" "+'option:contains('+ el.codeNm +')').prop('selected', true);
	    	}) */
	 	}
	 	
	    //선택 버튼클릭시 
	    function selectItem(obj) {
			console.log(obj);
			opener.setResult(obj); //부모창에 구현
			window.close();
	    }
	    
	    //팝업에서 받은 결과 처리
	    function setResult(obj) {
			$("#userId").val(obj.userId);
			$("#userNm").val(obj.userNm);
	    }
	    
	 	// 자산 유형 부모 요소 찾아서 return
	 	function getAsetType(asetType1) {
	 		return asetType.filter( function(el) {
	 			return el.uppCodeId == asetType1;
	 		});
	 	}
	 	
	 	// 자산 유형 옵션 그리기
	 	function makeAsetCombo(objNm, arr) {
	 		$(objNm).empty();
	 		
	 		$(objNm).append('<option value="">선택</option>');
	 		
	 		$.each(arr, function(i, e) {
	 			$(objNm).append('<option value="'+ e.codeId+'">' + e.codeNm+ '</option>');
	 		});
	 	}
	    
	    function enterkey() {
	    	if (window.event.keyCode == 13) {
	    		$("#jsGrid").jsGrid().trigger("loadData");
	        }
	    }
		   
	    function getAsetTypeId1(id, selectVal) {
			intId = id.replace(/[^0-9]/g,'');
			intId1 = Number(intId)+10;
			intId2 = Number(intId)+20;
			
			ObjNm1 = "#asetType"+intId1;
			ObjNm2 = "#asetType"+intId2;
			
			makeAsetCombo(ObjNm1, getAsetType(selectVal))
		   	makeAsetCombo(ObjNm2, "")
	    }
	    
	    function getAsetTypeId2(id, selectVal) {
			intId = id.replace(/[^0-9]/g,'');
			intId1 = Number(intId)+10;
			intId2 = Number(intId)+20;
			
			ObjNm1 = "#asetType"+intId1;
			ObjNm2 = "#asetType"+intId2;
			
			makeAsetCombo(ObjNm1, getAsetType(selectVal))
	    }
	    
	    </script>	
	</th:block>

	<div layout:fragment="content">
		<!-- contents_head -->
		<div class="bc">Home &gt; <span> 자산변동 > 자산수정의뢰작성</span></div>
		<h3><span>자산수정의뢰작성</span></h3><br>
		<!-- //contents_head -->

		<!-- search -->
		
		<div class="list_head">
			<div style="font-weight:bold;">의뢰정보</div>
			<div class="button">
				<a class="btn_add">저장</a>
				<a class="btn_add">삭제</a>
				<a class="btn_add">결재상신</a>
			</div>
		</div>
		
		<div class="srch_wrap single">
			<table class="srch_table" style="margin-top: 15px">
				<colgroup>
					<col style="width:5%"/>
					<col style="width:10%"/>
					<col style="width:15%"/>
					<col style="width:5%"/>
					<col style="width:10%"/>
					<col style="width:15%"/>
					<col style="width:5%"/>
					<col style="width:10%"/>
					<col style="width:15%"/>
					<col style="width:5%"/>
				</colgroup>
				<tr>
					<!-- <td>
						<select id="asetType1" style="width:100%;">
							<option value="">[[#{screen.text.comm.choice}]]</option>
						</select>
					</td> -->
					<td><input id="req_no" type="hidden" th:value="${reqNo}"></td>
						<th style="text-align:center;">의뢰구분</th>
						<td><input type="text" id="reqType" style="width:100%;"></td>
					<td></td>
						<th style="text-align:center;">의뢰번호</th>
						<td><input type="text" id="reqNo" style="width:100%;"></td>
					<td></td> 
						<th style="text-align:center;">의뢰일시</th>
						<td><input type="date" id="reqDt" style="width:100%;"></td>
					<td></td>
				</tr>
				<tr>
					<td></td>
					<th style="text-align:center;">의뢰부서</th>
					<td>
						<input type="text" style=" width:100%" id="deptNm" readonly/>
						<!-- <input type="text" style="width:100%" id="dept_cd1" /> -->
					</td>
					<td>
						<a href="#" id="openDeptPopup1" style="margin-left: 10px;"><img title="의뢰자 검색" class="ico_search" alt="Search" src="/images/common/ico_search.png"></a>
					</td>
					<th style="text-align:center;">의뢰자</th>
					<td>
						<input type="text" style="width:100%" id="reqtr" readonly/>
					</td>
					<td>
						<a href="#" id="openDeptPopup2" style="margin-left: 10px;"><img title="의뢰자 검색" class="ico_search" alt="Search" src="/images/common/ico_search.png"></a>
					</td>
					<th style="text-align:center;">의뢰명</th>
						<td><input type="text" id="reqNm" style="width:100%;"></td>
					<td></td>
				</tr>
				<tr>
					<td></td>
					<th style="text-align:center;">의뢰사유</th>
					<td colspan="1"><input type="text" id="reqRsn" style="width:100%;"/></td>
					<td></td>
				</tr>
				<tr>
					<td class="search" colspan="10 ">
						<a href="#;" class="btn_reset">Reset</a>
						<a href="#;" class="btn_srch">Search</a>
					</td>
				</tr>
			</table>
		</div><br>
		<!-- //search -->
		<div class="list_head">
				<!-- <div style="font-weight:bold;">
					의뢰정보
				</div> -->
				<div class="result">Results : 0,000</div>
				<!-- <div class="result">Results : 0,000</div> -->
				<!-- list_button -->
				<div class="button">
					<a class="btn_add">자산 추가</a>
					<a class="btn_del">삭제</a>
				</div>
				
				<!-- list_button -->
		</div>
		<!-- list -->
		<!-- //search -->

		<!-- list -->
		<div id="jsGrid"></div>
		<input type="hidden" id="curr_Idx"/>
		<!-- //list -->
	
		<!-- detail popup -->
		<div id="detailForm" class="list_head" style="display:none;">
		  <div id="container">
			  
		        <!-- list_head -->
				<div class="list_head">
					<h6><span id="head_title" ></span></h6>
					<!-- list_button -->
					<div class="button">
						<a class="btn_list save_btn">저장</a>
						<a class="btn_list close_btn">닫기</a>
					</div>
					<!-- list_button -->
				</div>
				<!-- //list_head -->
				<!-- detail_table -->
					<table class="detail_table ">
						<colgroup>
							<col style="width:20%" />
							<col style="width:30%" />
							<col style="width:20%" />
							<col style="width:30%" />
						<col />
						<tr>
							<th style="text-align: center;">의뢰번호</th>
							<td><input type="text" style="width:100%;" id="reqNo" /></td>
							<th style="text-align: center;">의뢰구분</th>
							<td>
								<select id="reqType" style="width:100%;">
									<option value="">선택</option>
								</select>
							</td>
						</tr>
						<tr>
							<th style="text-align: center;">의뢰명</th>
							<td colspan="4"><input type="text" style="width:100%" id="reqNm" /></td>
						</tr>
						<tr>
							<th style="text-align: center;">의뢰자</th>
							<td class="aset_td">
								<input type="text" style="width:100%" id="reqtr" readonly/>
								<a href="#" id="openUserPopup" ><img title="의뢰자 검색" class="ico_search" alt="Search" src="/images/common/ico_search.png"></a>
							</td>
							<th style="text-align: center;">의뢰 상태</th>
							<td>
								<select id="reqStus" style="width:100%;">
									<option value="">선택</option>
								</select>
							</td>
						</tr>
						<tr>
							<th style="text-align: center;">의뢰 사유</th>
							<td colspan="4"><input type="text" style="width:100%" id="reqRsn" /></td>
						</tr>
						<tr>
							<th style="text-align: center;">이동 목적</th>
							<td><input type="text" style="width:100%" id="movePupos" /></td>
							<th style="text-align: center;">이동일자</th>
							<td><input type="date" style="width:100%" id="moveDt" /></td>
						</tr>
						<tr>
							<th style="text-align: center;">결재문서 ID</th>
							<td><input type="text" style="width:100%" id="appvDocId"/></td>
							<th style="text-align: center;">진행중단여부</th>
							<td>
								<select id="prgsDcontYn" style="width:100%">
									<option value="">선택</option>
									<option value="Y">사용</option>
									<option value="N">미사용</option>
								</select>
							</td>
						</tr>
						<tr>
							<th style="text-align: center;">반출예정 여부</th>
							<td>
								<select id="tkoutScheYn" style="width:100%">
									<option value="">선택</option>
									<option value="Y">사용</option>
									<option value="N">미사용</option>
								</select>
							</td>
							<th style="text-align: center;">반출 예정일자</th>
							<td><input type="date" style="width:100%" id="tkoutScheDt" /></td>
						</tr>
						<tr>
							<th style="text-align: center;">반출 여부</th>
							<td>
								<select id="tkoutYn" style="width:100%">
									<option value="">선택</option>
									<option value="Y">사용</option>
									<option value="N">미사용</option>
								</select>
							</td>
							<th style="text-align: center;">반출일자</th>
							<td><input type="date" style="width:100%" id="tkoutDt" /></td>
						</tr>
						<tr>
							<th style="text-align: center;">재반입 여부</th>
							<td>
								<select id="rtkinYn" style="width:100%">
									<option value="">선택</option>
									<option value="Y">사용</option>
									<option value="N">미사용</option>
								</select>
							</td>
							<th style="text-align: center;">재반입일자</th>
							<td><input type="date" style="width:100%" id="rtKinDt" /></td>
						</tr>
					</table>
				<!-- //detail_table -->
				 
	     	</div>
     	</div>
		
		<div id="excelDownTarget"></div>
		
	</div>
	
</html>