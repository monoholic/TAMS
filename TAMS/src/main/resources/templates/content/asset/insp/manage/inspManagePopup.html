<!DOCTYPE html>
<html 	xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorator="layout/popup2">

	<head>
	    <title>[[#{screen.text.asset.asetInspReg}]]</title>
	</head>
        
	<!-- css -->
	<th:block layout:fragment="css">
	    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,600,400' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="/css/jsgrid.css" />
		<link rel="stylesheet" href="/css/theme.css" />
	</th:block>  
	
	<th:block layout:fragment="script">
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>
		<script src="/js/jsgrid/db.js"></script>
	    <script src="/js/jsgrid/jsgrid.core.js"></script>
	    <script src="/js/jsgrid/jsgrid.load-indicator.js"></script>
	    <script src="/js/jsgrid/jsgrid.load-strategies.js"></script>
	    <script src="/js/jsgrid/jsgrid.sort-strategies.js"></script>
	    <script src="/js/jsgrid/jsgrid.field.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.text.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.number.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.select.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.checkbox.js"></script>
	    <script src="/js/jsgrid/fields/jsgrid.field.control.js"></script>	
	
		<script>
		  	const chooseAsset = "[[#{screen.info.status.inv.choose.assettype3}]]";
		  	const noAssetProperty = "[[#{screen.info.status.inv.no.asset.property}]]"
				
		  	
			$(function(){
				
				let asetType = [];
				
		    	//항목값 설정
				//$("#inspNo").html(invData.inspNo);
				
				//공통코드 조회
		        //getCommCode("#bsplc"	, "SITE"		, ""	, "");
		        
		        /*------------------------ Event ------------------------*/
	    	  			
		        // 닫기
				$(".pop_close").on("click",function(){ 
					window.close();
				});			    	  	
	    	  			
		        // 마감
				$(".btn_deadline").on("click",function(){ 
					window.close();
				});			    	  	
		        
		        //저장
	     	    $(".btn_save").on("click",function() {

	     	    	var inspNm = $("#inspNm").val();
	     	    	if(inspNm == "" || inspNm == "undefined"){ /* 실사명은 필수항목입니다. */
	     	    		alert("[[#{screen.text.asset.inspNm}]] [[#{screen.info.status.required.input}]]");
	     	    		return false;
	     	    	}
	     	    	
	     	    	var inspStDt = $("#inspStDt").val();
	     	    	if(inspStDt == "" || inspStDt == "undefined"){ /* 실사시작일은 필수항목입니다. */
	     	    		alert("[[#{screen.text.asset.inspStDt}]] [[#{screen.info.status.required.input}]]");
	     	    		return false;
	     	    	}else{
	     	    		inspStDt = inspStDt.replace(/-/gi, "");; // 대시 제거, 컬럼형식 yyyymmdd
	     	    	}
	     	    	
	     	    	var inspEndDt = $("#inspEndDt").val();
	     	    	if(inspEndDt == "" || inspEndDt == "undefined"){ /* 실사종료일은 필수항목입니다. */
	     	    		alert("[[#{screen.text.asset.inspStDt}]] [[#{screen.info.status.required.input}]]");
	     	    		return false;
	     	    	}else{
	     	    		inspEndDt = inspEndDt.replace(/-/gi, ""); // 대시 제거, 컬럼형식 yyyymmdd
	     	    	}
	     	    	
	     	    	var onlineInspBaseDt = $("#onlineInspBaseDt").val();
	     	    	if(onlineInspBaseDt != "" && onlineInspBaseDt != "undefined"){
	     	    		onlineInspBaseDt = onlineInspBaseDt.replace(/-/gi, "");  // 대시 제거, 컬럼형식 yyyymmdd
	     	    	}
	     	    	
		  	    	let url = "/asset/insp/manage/insertInspMaster";
		  			let reqType = 'POST';
		  			dataType: 'json';
		  			let data={
		  				inspNm           : inspNm,
		  				inspStDt         : inspStDt,
		  				inspEndDt        : inspEndDt,
		  				onlineInspBaseDt : onlineInspBaseDt,
		  				regr             : $("#regr").val(),
		  				inspStus         : "NL"  //정상
		  			}
		  			$.commRequest(url, reqType, JSON.stringify(data))
						.then((res) => {
							console.log(res);
							alert("[[#{screen.info.status.save.success}]]");							
							//opener.parent.search();
							opener.$('.btn_srch').click();
							window.close();
						}).catch((error) => {
							console.log("[[#{screen.info.status.error.occur}]]");
							console.log(error);
						});    					
    			});		        
		        
		        		        
			});
			
		</script>
	
	</th:block>

	<div layout:fragment="content">

		<!-- container -->
		<div id="container-pop">
			<!-- contents -->
			<div id="contents">
				<!-- contents_head -->
				<h3>
					[[#{screen.text.asset.asetInspReg}]]
					<a href="#;" class="pop_close" title="닫기">[[#{screen.text.comm.close}]]</a>
				</h3>
				<!-- //contents_head -->
					<div align="right" class="button">
						<a href="#;" class="btn_save"    >[[#{screen.text.comm.save}]]      </a> <!-- 저장 -->
						<a href="#;" class="btn_deadline">[[#{screen.text.comm.deadline}]]  </a> <!-- 마감 -->
					</div>
					<p class="space10"></p>
				
				<!-- input_table -->
				<table class="detail_table form_s">
					<colgroup>
					<col style="width:12%" />
					<col style="width:20%" />
					<col style="width:12%" />
					<col style="width:20%" />
					<col style="width:12%" />
					<col style="width:20%" />
					</colgroup>
					<tr>
						<th>[[#{screen.text.asset.inspNm}]]</th><!-- 실사명 -->
						<td colspan="3"><input type="text" id="inspNm" style="width:100%;" ></td>
						<th>[[#{screen.text.asset.inspStus}]]</th><!-- 실사상태 -->
						<td>임시저장</td>
					</tr>
					<tr>
						<th>[[#{screen.text.asset.inspStDt}]]</th><!-- 실사시작일 -->
						<td>
							<div style='display:flex'><input type="date" id="inspStDt" style="width:100%"></div>
						</td>
						<th>[[#{screen.text.asset.inspEndDt}]]</th><!-- 실사종료일 -->
						<td>
							<div style='display:flex'><input type="date" id="inspEndDt" style="width:100%"></div>
						</td>
						<th>[[#{screen.text.asset.onlineInspBaseDt}]]</th><!-- 온라인실사기준일 -->
						<td>
							<div style='display:flex'><input type="date" id="onlineInspBaseDt" style="width:100%"></div>
						</td>
					</tr>
					<tr>
						<th>[[#{screen.text.asset.inspRegr}]]</th><!-- 생성자 -->
						<td><input type="text" id="regr" disabled="disabled" style="width:100%;" th:value="${regr}"> </td>
						<th>[[#{screen.text.asset.inspRegDt}]]</th><!-- 생성일자 -->
						<td><input type="text" id="regDt" disabled="disabled" style="width:100%;" th:value="${regDt}"></td>
						<th>[[#{screen.text.asset.inspProgressRate}]]</th><!-- 실사진행율 -->
						<td><input type="text" id="inspProgressRate" disabled="disabled" style="width:100%;" value="0%"></td>
					</tr>
				</table>
				<!-- //input_table -->				
				
				<p class="space10"></p>

			</div>
			<!-- //contents -->
		</div>
		<!-- //container -->
	</div>			
</html>