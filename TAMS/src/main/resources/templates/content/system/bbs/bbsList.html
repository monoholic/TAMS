<!DOCTYPE html>
<html 	xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorator="layout/default">

	<head>
	    <title>[[#{screen.text.bbs.screen.title}]]</title>
	</head>
        
	<!-- css -->
	<th:block layout:fragment="css">	
	    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,600,400' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="/css/theme.css" />
		<link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.0.8/css/tabulator.min.css" rel="stylesheet"> 
	</th:block>   
	
	<th:block layout:fragment="script">
		<script type="text/javascript" src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
		<script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.0.7/dist/js/tabulator.min.js"></script>
		
	    <script>
	
		    let grid;
		    let requestUrl =  "/system/bbs/bbsMng/bbsList";
	    
		    
		    $(function(){
		    	
				grid = new Tabulator("#data-table", {
				 	locale:true,
				    langs: $.commGridLocalization(),								
				 	height:"560",
				 	layout:"fitColumns",
				 	movableColumns:true,
				 	pagination:true,
				 	paginationMode:"remote",
				 	ajaxURL:requestUrl,			
				 	ajaxParams: getParams(),
				 	paginationSize:20,				    
				 	paginationSizeSelector:[20, 50, 100, 500],			
				 	dataSendParams:{
				        "page":"currentPage",
				        "size":"numOfRows"
				    } ,							    
				 	placeholder:"No Data Set",				 	
				 	ajaxResponse:function(url, params, res){
				 		$(".result").text("Totals : " + res.condition.totalCount);
						condition = res.condition;				 						 		
				 		return res;
				 	},					 	
				 	columns:[ 
		                {title: "[[#{screen.text.bbs.no}]]"      		, field: "bbsId"		,   hozAlign: "center"	, headerHozAlign:"center" , width:90, headerSort:false},
		                {title: "[[#{screen.text.bbs.title}]]"   		, field: "bbsTtl"		,  hozAlign: "left"  		, headerHozAlign:"center"},
		                {title: "[[#{screen.text.comm.regr}]]"   , field: "userId"		,  hozAlign: "center"		, headerHozAlign:"center", width:130},
		                {title: "[[#{screen.text.comm.regdt}]]" 	, field: "regDt" 		,  hozAlign: "center"		, headerHozAlign:"center", width:130},
		                {title: "[[#{screen.text.bbs.view.cnt}]]"	, field: "viewCnt"	, hozAlign: "center"		, headerHozAlign:"center", width:100},
				 	],
				});					    	
	
				/*------------------------- Grid Events -------------------------*/
				//row click
				grid.on("rowClick", function(e, row){	
					var rowData = row.getData();		
					showDetailBbs(row.getData());
				});				            
	            
		    	/* ------------------------ UI Events  ------------------------*/
		    	
	    	    $(".btn_srch").on("click",function (){
	    	    	grid.setData(requestUrl, getParams());
		        });
		        
	          	//리셋 버튼
	    	    $(".btn_reset").click(function() {
	    	    	$("#searchText").val("");
	    	    	$("#searchOption option:eq(0)").prop("selected",true);
	    	    	$("#delYnOption option:eq(0)").prop("selected",true);
	    	    });
	    	});
		    
		    function showDetailBbs(item) {
		    	var $form = $('<form id="form"></form>'); 
				$form.attr('action', "/system/bbs/detailBbs"); 
				$form.attr('method', 'post'); 
				$form.appendTo('body');
				
				var bbsIdStr = $('<input type="hidden" value="'+item.bbsId+'" name="bbsId">');
				
				$form.append(bbsIdStr);
				
				$form.submit();
		    }
		    
		    function enterkey() {
		    	if (window.event.keyCode == 13) {
		    		$('.btn_srch').click();
		        }
		    }
		    
	        function getParams(){
				return {
    				"searchText"   : $("#searchText").val(),
    				"searchOption" : $("#searchOption option:selected").val(),
    				"useYnOption"  : $("#delYnOption option:selected").val(),					
				}
	         }  		    
	    </script>	
	</th:block>

	<div layout:fragment="content">
		<!-- contents_head -->
		<div class="bc">Home &gt; <span th:text="${menuDesc}"></span></div>
		<h3><span th:text="${menuNm}"></span></h3>
		<!-- //contents_head -->

		<!-- search -->
		<div class="srch_wrap single">
			<table class="srch_table">
				<tr>
					<td>
						<div style="display: flex; align-items: stretch;">
							<select id="searchOption">
								<option value="">[[#{screen.text.comm.select.search.condition}]]</option>
								<option value="bbs_ttl">[[#{screen.text.bbs.title}]]</option>
							</select>
							<input id="searchText" type="text" onkeyup="enterkey()" placeholder="검색어를 입력해주세요." style="margin-left: 5px;">
						</div>
					</td>
					<td class="search" colspan="3">
						<a href="#;" class="btn_reset">[[#{screen.btn.reset}]]</a>
						<a href="#;" class="btn_srch">[[#{screen.btn.search}]]</a>
					</td>
				</tr>
			</table>
		</div>
		<!-- //search -->
		<div class="list_head">
			<div class="result">Totals : 0,000</div>
		</div>
		<!-- //search -->

		<!-- list -->
		<div id="data-table"></div>
		<!-- list -->
	</div>
</html>