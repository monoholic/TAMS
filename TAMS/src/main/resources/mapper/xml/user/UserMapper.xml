<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.trito.tams.web.user.mapper.UserMapper">
   
	<insert id="insertUser" parameterType="kr.co.trito.tams.web.user.dto.UserDto">
		INSERT INTO user (
		      email
		    , password
		    , name
		    , use_yn
		    , udt
		    , updr
		    , rdt
		    , regr 
		) VALUES (
			  #{email}
			, #{password}
		    , #{name}
		    , #{useYn}
		    , now()
		    , #{updr}
		    , now()
		    , #{regr} 
		)
	</insert>        

	<insert id="insertUserRole" parameterType="hashMap">
		INSERT INTO user_has_role (
		      email
		    , role_id
		    , use_yn
		    , udt
		    , updr
		    , rdt
		    , regr  
		) VALUES (
			#{email}
		    , #{roleId}
		    , #{useYn}
		    , now()
		    , #{updr}
		    , now()
		    , #{regr} 		    
		)
	</insert>  

  	<select id="selectUserByEmail" resultType="kr.co.trito.tams.web.user.dto.UserDto">  
		SELECT user_id
			, user_pw
		    , user_Nm
		    , email
		    , use_yn
		    , updt
		    , updr
		    , regdt
		    , regr		    
		FROM tb_user
		WHERE user_id = 'test2' <!-- #{email} --> 
  	</select> 	
  
  	<select id="selectUserRoleByEmail" resultType="String">
		SELECT B.ROLE_ID
		FROM TB_USER_ROLE a
		INNER JOIN TB_COM_ROLE b
		  ON a.role_id = b.role_id
		WHERE a.user_id = #{userId}   	
  	</select>
</mapper>